<div class="ventas-container">
  <div class="content">
    <div class="search-section">
      <div class="search-bar">
        <input 
          type="text" 
          [(ngModel)]="terminoBusqueda"
          (input)="buscarVenta()"
          placeholder="Buscar venta"
          class="search-input"
        >
        <button class="search-button">
          <span class="icon">üîç</span>
        </button>
      </div>
    </div>

    <div class="nueva-venta-section">
      <button class="btn-nueva-venta" (click)="navegarNuevaVenta()">
        <span class="icon">+</span> Nueva venta
      </button>
    </div>

    <div class="ventas-list">
      <div 
        *ngFor="let venta of ventasFiltradas" 
        class="venta-item"
        (click)="verDetalleVenta(venta)"
      >
        <div class="venta-icon">
          <span>üßæ</span>
        </div>
        <div class="venta-info">
          <h3>{{ venta.nombreEstudiante }} - ${{ venta.total?.toLocaleString() }}</h3>
          <p>{{ formatearFecha(venta.fecha) }}</p>
        </div>
        <button class="view-button" (click)="verDetalleVenta(venta); $event.stopPropagation()">
          <span class="icon">üëÅÔ∏è</span>
        </button>
      </div>

      <div *ngIf="ventasFiltradas.length === 0" class="no-ventas">
        <p>No se encontraron ventas</p>
      </div>
    </div>
  </div>

  <!-- Modal de detalle de venta -->
  <div class="modal-overlay" *ngIf="ventaSeleccionada" (click)="cerrarDetalle()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Detalle de Venta #{{ ventaSeleccionada.idVenta }}</h2>
        <button class="close-button" (click)="cerrarDetalle()">‚úï</button>
      </div>
      
      <div class="modal-body">
        <div class="detalle-section">
          <h3>Informaci√≥n General</h3>
          <div class="detalle-item">
            <span class="label">Fecha:</span>
            <span class="value">{{ formatearFecha(ventaSeleccionada.fecha) }}</span>
          </div>
          <div class="detalle-item">
            <span class="label">Cliente:</span>
            <span class="value">{{ ventaSeleccionada.nombreEstudiante }}</span>
          </div>
          <div class="detalle-item">
            <span class="label">Curso:</span>
            <span class="value">{{ ventaSeleccionada.cursoEstudiante }}</span>
          </div>
          <div class="detalle-item">
            <span class="label">M√©todo de Pago:</span>
            <span class="value">{{ ventaSeleccionada.metodoPago }}</span>
          </div>
        </div>

        <div class="detalle-section">
          <h3>Productos Vendidos</h3>
          <div class="productos-vendidos">
            <div *ngFor="let item of getProductosVendidos(ventaSeleccionada)" class="producto-vendido">
              <span class="producto-nombre">{{ item.nombre }}</span>
              <span class="producto-cantidad">x{{ item.cantidad }}</span>
              <span class="producto-precio">${{ item.precio?.toLocaleString() }}</span>
              <span class="producto-subtotal">${{ (item.precio! * item.cantidad).toLocaleString() }}</span>
            </div>
          </div>
        </div>

        <div class="detalle-section total-section">
          <div class="detalle-item total">
            <span class="label">Total:</span>
            <span class="value">${{ ventaSeleccionada.total?.toLocaleString() }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
